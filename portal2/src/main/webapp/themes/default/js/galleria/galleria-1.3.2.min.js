(function(e,t,n){var r=this,i=r.document,s=e(i),o=e(r),u=Array.prototype,a=1.32,f=true,l=3e4,c=false,h=navigator.userAgent.toLowerCase(),p=r.location.hash.replace(/#\//,""),d=r.location.protocol,v=Math,m=function(){},g=function(){return false},y=function(){var e=3,t=i.createElement("div"),r=t.getElementsByTagName("i");do{t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->"}while(r[0]);return e>4?e:n}(),b=function(){return{html:i.documentElement,body:i.body,head:i.getElementsByTagName("head")[0],title:i.title}},w=r.parent!==r.self,E="data ready thumbnail loadstart loadfinish image play pause progress "+"fullscreen_enter fullscreen_exit idle_enter idle_exit rescale "+"lightbox_open lightbox_close lightbox_image",S=function(){var t=[];e.each(E.split(" "),function(e,n){t.push(n);if(/_/.test(n)){t.push(n.replace(/_/g,""))}});return t}(),x=function(t){var n;if(typeof t!=="object"){return t}e.each(t,function(r,i){if(/^[a-z]+_/.test(r)){n="";e.each(r.split("_"),function(e,t){n+=e>0?t.substr(0,1).toUpperCase()+t.substr(1):t});t[n]=i;delete t[r]}});return t},T=function(n){if(e.inArray(n,S)>-1){return t[n.toUpperCase()]}return n},N={youtube:{reg:/https?:\/\/(?:[a-zA_Z]{2,3}.)?(?:youtube\.com\/watch\?)((?:[\w\d\-\_\=]+&(?:amp;)?)*v(?:&lt;[A-Z]+&gt;)?=([0-9a-zA-Z\-\_]+))/i,embed:function(){return"http://www.youtube.com/embed/"+this.id},getUrl:function(){return d+"//gdata.youtube.com/feeds/api/videos/"+this.id+"?v=2&alt=json-in-script&callback=?"},get_thumb:function(e){return e.entry.media$group.media$thumbnail[2].url},get_image:function(e){if(e.entry.yt$hd){return d+"//img.youtube.com/vi/"+this.id+"/maxresdefault.jpg"}return e.entry.media$group.media$thumbnail[3].url}},vimeo:{reg:/https?:\/\/(?:www\.)?(vimeo\.com)\/(?:hd#)?([0-9]+)/i,embed:function(){return"http://player.vimeo.com/video/"+this.id},getUrl:function(){return d+"//vimeo.com/api/v2/video/"+this.id+".json?callback=?"},get_thumb:function(e){return e[0].thumbnail_medium},get_image:function(e){return e[0].thumbnail_large}},dailymotion:{reg:/https?:\/\/(?:www\.)?(dailymotion\.com)\/video\/([^_]+)/,embed:function(){return d+"//www.dailymotion.com/embed/video/"+this.id},getUrl:function(){return"https://api.dailymotion.com/video/"+this.id+"?fields=thumbnail_240_url,thumbnail_720_url&callback=?"},get_thumb:function(e){return e.thumbnail_240_url},get_image:function(e){return e.thumbnail_720_url}},_inst:[]},C=function(t,n){for(var r=0;r<N._inst.length;r++){if(N._inst[r].id===n&&N._inst[r].type==t){return N._inst[r]}}this.type=t;this.id=n;this.readys=[];N._inst.push(this);var i=this;e.extend(this,N[t]);e.getJSON(this.getUrl(),function(t){i.data=t;e.each(i.readys,function(e,t){t(i.data)});i.readys=[]});this.getMedia=function(e,t,n){n=n||m;var r=this;var i=function(n){t(r["get_"+e](n))};try{if(r.data){i(r.data)}else{r.readys.push(i)}}catch(s){n()}}},k=function(e){var t;for(var n in N){t=e&&N[n].reg&&e.match(N[n].reg);if(t&&t.length){return{id:t[2],provider:n}}}return false},L={support:function(){var e=b().html;return!w&&(e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullScreen)}(),callback:m,enter:function(e,t,n){this.instance=e;this.callback=t||m;n=n||b().html;if(n.requestFullscreen){n.requestFullscreen()}else if(n.mozRequestFullScreen){n.mozRequestFullScreen()}else if(n.webkitRequestFullScreen){n.webkitRequestFullScreen()}},exit:function(e){this.callback=e||m;if(i.exitFullscreen){i.exitFullscreen()}else if(i.mozCancelFullScreen){i.mozCancelFullScreen()}else if(i.webkitCancelFullScreen){i.webkitCancelFullScreen()}},instance:null,listen:function(){if(!this.support){return}var e=function(){if(!L.instance){return}var e=L.instance._fullscreen;if(i.fullscreen||i.mozFullScreen||i.webkitIsFullScreen){e._enter(L.callback)}else{e._exit(L.callback)}};i.addEventListener("fullscreenchange",e,false);i.addEventListener("mozfullscreenchange",e,false);i.addEventListener("webkitfullscreenchange",e,false)}},A=[],O=[],M=false,_=false,D=[],P=function(n){t.theme=n;e.each(D,function(e,t){if(!t._initialized){t._init.call(t)}});D=[]},H=function(){return{clearTimer:function(n){e.each(t.get(),function(){this.clearTimer(n)})},addTimer:function(n){e.each(t.get(),function(){this.addTimer(n)})},array:function(e){return u.slice.call(e,0)},create:function(e,t){t=t||"div";var n=i.createElement(t);n.className=e;return n},removeFromArray:function(t,n){e.each(t,function(e,r){if(r==n){t.splice(e,1);return false}});return t},getScriptPath:function(t){t=t||e("script:last").attr("src");var n=t.split("/");if(n.length==1){return""}n.pop();return n.join("/")+"/"},animate:function(){var n=function(e){var t="transition WebkitTransition MozTransition OTransition".split(" "),n;if(r.opera){return false}for(n=0;t[n];n++){if(typeof e[t[n]]!=="undefined"){return t[n]}}return false}((i.body||i.documentElement).style);var s={MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[n];var o={_default:[.25,.1,.25,1],galleria:[.645,.045,.355,1],galleriaIn:[.55,.085,.68,.53],galleriaOut:[.25,.46,.45,.94],ease:[.25,0,.25,1],linear:[.25,.25,.75,.75],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]};var u=function(t,n,r){var i={};r=r||"transition";e.each("webkit moz ms o".split(" "),function(){i["-"+this+"-"+r]=n});t.css(i)};var a=function(e){u(e,"none","transition");if(t.WEBKIT&&t.TOUCH){u(e,"translate3d(0,0,0)","transform");if(e.data("revert")){e.css(e.data("revert"));e.data("revert",null)}}};var f,l,c,h,p,d,v;return function(i,g,y){y=e.extend({duration:400,complete:m,stop:false},y);i=e(i);if(!y.duration){i.css(g);y.complete.call(i[0]);return}if(!n){i.animate(g,y);return}if(y.stop){i.unbind(s);a(i)}f=false;e.each(g,function(e,t){v=i.css(e);if(H.parseValue(v)!=H.parseValue(t)){f=true}i.css(e,v)});if(!f){r.setTimeout(function(){y.complete.call(i[0])},y.duration);return}l=[];c=y.easing in o?o[y.easing]:o._default;h=" "+y.duration+"ms"+" cubic-bezier("+c.join(",")+")";r.setTimeout(function(n,r,i,s){return function(){n.one(r,function(e){return function(){a(e);y.complete.call(e[0])}}(n));if(t.WEBKIT&&t.TOUCH){p={};d=[0,0,0];e.each(["left","top"],function(e,t){if(t in i){d[e]=H.parseValue(i[t])-H.parseValue(n.css(t))+"px";p[t]=i[t];delete i[t]}});if(d[0]||d[1]){n.data("revert",p);l.push("-webkit-transform"+s);u(n,"translate3d("+d.join(",")+")","transform")}}e.each(i,function(e,t){l.push(e+s)});u(n,l.join(","));n.css(i)}}(i,s,g,h),2)}}(),removeAlpha:function(e){if(e instanceof jQuery){e=e[0]}if(y<9&&e){var t=e.style,n=e.currentStyle,r=n&&n.filter||t.filter||"";if(/alpha/.test(r)){t.filter=r.replace(/alpha\([^)]*\)/i,"")}}},forceStyles:function(t,n){t=e(t);if(t.attr("style")){t.data("styles",t.attr("style")).removeAttr("style")}t.css(n)},revertStyles:function(){e.each(H.array(arguments),function(t,n){n=e(n);n.removeAttr("style");n.attr("style","");if(n.data("styles")){n.attr("style",n.data("styles")).data("styles",null)}})},moveOut:function(e){H.forceStyles(e,{position:"absolute",left:-1e4})},moveIn:function(){H.revertStyles.apply(H,H.array(arguments))},hide:function(t,n,r){r=r||m;var i=e(t);t=i[0];if(!i.data("opacity")){i.data("opacity",i.css("opacity"))}var s={opacity:0};if(n){var o=y<9&&t?function(){H.removeAlpha(t);t.style.visibility="hidden";r.call(t)}:r;H.animate(t,s,{duration:n,complete:o,stop:true})}else{if(y<9&&t){H.removeAlpha(t);t.style.visibility="hidden"}else{i.css(s)}}},show:function(t,n,r){r=r||m;var i=e(t);t=i[0];var s=parseFloat(i.data("opacity"))||1,o={opacity:s};if(n){if(y<9){i.css("opacity",0);t.style.visibility="visible"}var u=y<9&&t?function(){if(o.opacity==1){H.removeAlpha(t)}r.call(t)}:r;H.animate(t,o,{duration:n,complete:u,stop:true})}else{if(y<9&&o.opacity==1&&t){H.removeAlpha(t);t.style.visibility="visible"}else{i.css(o)}}},wait:function(n){t._waiters=t._waiters||[];n=e.extend({until:g,success:m,error:function(){t.raise("Could not complete wait function.")},timeout:3e3},n);var i=H.timestamp(),s,o,u,a=function(){o=H.timestamp();s=o-i;H.removeFromArray(t._waiters,u);if(n.until(s)){n.success();return false}if(typeof n.timeout=="number"&&o>=i+n.timeout){n.error();return false}t._waiters.push(u=r.setTimeout(a,10))};t._waiters.push(u=r.setTimeout(a,10))},toggleQuality:function(e,t){if(y!==7&&y!==8||!e||e.nodeName.toUpperCase()!="IMG"){return}if(typeof t==="undefined"){t=e.style.msInterpolationMode==="nearest-neighbor"}e.style.msInterpolationMode=t?"bicubic":"nearest-neighbor"},insertStyleTag:function(t,n){if(n&&e("#"+n).length){return}var r=i.createElement("style");if(n){r.id=n}b().head.appendChild(r);if(r.styleSheet){r.styleSheet.cssText=t}else{var s=i.createTextNode(t);r.appendChild(s)}},loadScript:function(t,n){var r=false,i=e("<scr"+"ipt>").attr({src:t,async:true}).get(0);i.onload=i.onreadystatechange=function(){if(!r&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){r=true;i.onload=i.onreadystatechange=null;if(typeof n==="function"){n.call(this,this)}}};b().head.appendChild(i)},parseValue:function(e){if(typeof e==="number"){return e}else if(typeof e==="string"){var t=e.match(/\-?\d|\./g);return t&&t.constructor===Array?t.join("")*1:0}else{return 0}},timestamp:function(){return(new Date).getTime()},loadCSS:function(r,s,o){var u,a;e("link[rel=stylesheet]").each(function(){if((new RegExp(r)).test(this.href)){u=this;return false}});if(typeof s==="function"){o=s;s=n}o=o||m;if(u){o.call(u,u);return u}a=i.styleSheets.length;if(e("#"+s).length){e("#"+s).attr("href",r);a--}else{u=e("<link>").attr({rel:"stylesheet",href:r,id:s}).get(0);var f=e('link[rel="stylesheet"], style');if(f.length){f.get(0).parentNode.insertBefore(u,f[0])}else{b().head.appendChild(u)}if(y&&a>=31){t.raise("You have reached the browser stylesheet limit (31)",true);return}}if(typeof o==="function"){var l=e("<s>").attr("id","galleria-loader").hide().appendTo(b().body);H.wait({until:function(){return l.height()==1},success:function(){l.remove();o.call(u,u)},error:function(){l.remove()},timeout:5e3})}return u}}}(),B=function(t){var n=".galleria-videoicon{width:60px;height:60px;position:absolute;top:50%;left:50%;z-index:1;"+"margin:-30px 0 0 -30px;cursor:pointer;background:#000;background:rgba(0,0,0,.8);border-radius:3px;-webkit-transition:all 150ms}"+".galleria-videoicon i{width:0px;height:0px;border-style:solid;border-width:10px 0 10px 16px;display:block;"+"border-color:transparent transparent transparent #ffffff;margin:20px 0 0 22px}.galleria-image:hover .galleria-videoicon{background:#000}";H.insertStyleTag(n,"galleria-videoicon");return e(H.create("galleria-videoicon")).html("<i></i>").appendTo(t).click(function(){e(this).siblings("img").mouseup()})},j=function(){var t=function(t,n,r,i){var s=this.getOptions("easing"),o=this.getStageWidth(),u={left:o*(t.rewind?-1:1)},a={left:0};if(r){u.opacity=0;a.opacity=1}else{u.opacity=1}e(t.next).css(u);H.animate(t.next,a,{duration:t.speed,complete:function(e){return function(){n();e.css({left:0})}}(e(t.next).add(t.prev)),queue:false,easing:s});if(i){t.rewind=!t.rewind}if(t.prev){u={left:0};a={left:o*(t.rewind?1:-1)};if(r){u.opacity=1;a.opacity=0}e(t.prev).css(u);H.animate(t.prev,a,{duration:t.speed,queue:false,easing:s,complete:function(){e(this).css("opacity",0)}})}};return{active:false,init:function(e,t,n){if(j.effects.hasOwnProperty(e)){j.effects[e].call(this,t,n)}},effects:{fade:function(t,n){e(t.next).css({opacity:0,left:0});H.animate(t.next,{opacity:1},{duration:t.speed,complete:n});if(t.prev){e(t.prev).css("opacity",1).show();H.animate(t.prev,{opacity:0},{duration:t.speed})}},flash:function(t,n){e(t.next).css({opacity:0,left:0});if(t.prev){H.animate(t.prev,{opacity:0},{duration:t.speed/2,complete:function(){H.animate(t.next,{opacity:1},{duration:t.speed,complete:n})}})}else{H.animate(t.next,{opacity:1},{duration:t.speed,complete:n})}},pulse:function(t,n){if(t.prev){e(t.prev).hide()}e(t.next).css({opacity:0,left:0}).show();H.animate(t.next,{opacity:1},{duration:t.speed,complete:n})},slide:function(e,n){t.apply(this,H.array(arguments))},fadeslide:function(e,n){t.apply(this,H.array(arguments).concat([true]))},doorslide:function(e,n){t.apply(this,H.array(arguments).concat([false,true]))}}}}();L.listen();o.bind("orientationchange",function(){e(this).resize()});t=r.Galleria=function(){var u=this;this._options={};this._playing=false;this._playtime=5e3;this._active=null;this._queue={length:0};this._data=[];this._dom={};this._thumbnails=[];this._layers=[];this._initialized=false;this._firstrun=false;this._stageWidth=0;this._stageHeight=0;this._target=n;this._binds=[];this._id=parseInt(v.random()*1e4,10);var a="container stage images image-nav image-nav-left image-nav-right "+"info info-text info-title info-description "+"thumbnails thumbnails-list thumbnails-container thumb-nav-left thumb-nav-right "+"loader counter tooltip",f="current total";e.each(a.split(" "),function(e,t){u._dom[t]=H.create("galleria-"+t)});e.each(f.split(" "),function(e,t){u._dom[t]=H.create("galleria-"+t,"span")});var l=this._keyboard={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:false,press:function(e){var t=e.keyCode||e.which;if(t in l.map&&typeof l.map[t]==="function"){l.map[t].call(u,e)}},attach:function(e){var t,n;for(t in e){if(e.hasOwnProperty(t)){n=t.toUpperCase();if(n in l.keys){l.map[l.keys[n]]=e[t]}else{l.map[n]=e[t]}}}if(!l.bound){l.bound=true;s.bind("keydown",l.press)}},detach:function(){l.bound=false;l.map={};s.unbind("keydown",l.press)}};var c=this._controls={0:n,1:n,active:0,swap:function(){c.active=c.active?0:1},getActive:function(){return u._options.swipe?c.slides[u._active]:c[c.active]},getNext:function(){return u._options.swipe?c.slides[u.getNext(u._active)]:c[1-c.active]},slides:[],frames:[],layers:[]};var p=this._carousel={next:u.$("thumb-nav-right"),prev:u.$("thumb-nav-left"),width:0,current:0,max:0,hooks:[],update:function(){var t=0,n=0,r=[0];e.each(u._thumbnails,function(i,s){if(s.ready){t+=s.outerWidth||e(s.container).outerWidth(true);var o=e(s.container).width();t+=o-v.floor(o);r[i+1]=t;n=v.max(n,s.outerHeight||e(s.container).outerHeight(true))}});u.$("thumbnails").css({width:t,height:n});p.max=t;p.hooks=r;p.width=u.$("thumbnails-list").width();p.setClasses();u.$("thumbnails-container").toggleClass("galleria-carousel",t>p.width);p.width=u.$("thumbnails-list").width()},bindControls:function(){var e;p.next.bind("click",function(t){t.preventDefault();if(u._options.carouselSteps==="auto"){for(e=p.current;e<p.hooks.length;e++){if(p.hooks[e]-p.hooks[p.current]>p.width){p.set(e-2);break}}}else{p.set(p.current+u._options.carouselSteps)}});p.prev.bind("click",function(t){t.preventDefault();if(u._options.carouselSteps==="auto"){for(e=p.current;e>=0;e--){if(p.hooks[p.current]-p.hooks[e]>p.width){p.set(e+2);break}else if(e===0){p.set(0);break}}}else{p.set(p.current-u._options.carouselSteps)}})},set:function(e){e=v.max(e,0);while(p.hooks[e-1]+p.width>=p.max&&e>=0){e--}p.current=e;p.animate()},getLast:function(e){return(e||p.current)-1},follow:function(e){if(e===0||e===p.hooks.length-2){p.set(e);return}var t=p.current;while(p.hooks[t]-p.hooks[p.current]<p.width&&t<=p.hooks.length){t++}if(e-1<p.current){p.set(e-1)}else if(e+2>t){p.set(e-t+p.current+2)}},setClasses:function(){p.prev.toggleClass("disabled",!p.current);p.next.toggleClass("disabled",p.hooks[p.current]+p.width>=p.max)},animate:function(t){p.setClasses();var n=p.hooks[p.current]*-1;if(isNaN(n)){return}u.$("thumbnails").css("left",function(){return e(this).css("left")});H.animate(u.get("thumbnails"),{left:n},{duration:u._options.carouselSpeed,easing:u._options.easing,queue:false})}};var d=this._tooltip={initialized:false,open:false,timer:"tooltip"+u._id,swapTimer:"swap"+u._id,init:function(){d.initialized=true;var e=".galleria-tooltip{padding:3px 8px;max-width:50%;background:#ffe;color:#000;z-index:3;position:absolute;font-size:11px;line-height:1.3;"+"opacity:0;box-shadow:0 0 2px rgba(0,0,0,.4);-moz-box-shadow:0 0 2px rgba(0,0,0,.4);-webkit-box-shadow:0 0 2px rgba(0,0,0,.4);}";H.insertStyleTag(e,"galleria-tooltip");u.$("tooltip").css({opacity:.8,visibility:"visible",display:"none"})},move:function(e){var t=u.getMousePosition(e).x,n=u.getMousePosition(e).y,r=u.$("tooltip"),i=t,s=n,o=r.outerHeight(true)+1,a=r.outerWidth(true),f=o+15;var l=u.$("container").width()-a-2,c=u.$("container").height()-o-2;if(!isNaN(i)&&!isNaN(s)){i+=10;s-=o+8;i=v.max(0,v.min(l,i));s=v.max(0,v.min(c,s));if(n<f){s=f}r.css({left:i,top:s})}},bind:function(n,r){if(t.TOUCH){return}if(!d.initialized){d.init()}var i=function(){u.$("container").unbind("mousemove",d.move);u.clearTimer(d.timer);u.$("tooltip").stop().animate({opacity:0},200,function(){u.$("tooltip").hide();u.addTimer(d.swapTimer,function(){d.open=false},1e3)})};var s=function(t,n){d.define(t,n);e(t).hover(function(){u.clearTimer(d.swapTimer);u.$("container").unbind("mousemove",d.move).bind("mousemove",d.move).trigger("mousemove");d.show(t);u.addTimer(d.timer,function(){u.$("tooltip").stop().show().animate({opacity:1});d.open=true},d.open?0:500)},i).click(i)};if(typeof r==="string"){s(n in u._dom?u.get(n):n,r)}else{e.each(n,function(e,t){s(u.get(e),t)})}},show:function(t){t=e(t in u._dom?u.get(t):t);var n=t.data("tt"),i=function(e){r.setTimeout(function(e){return function(){d.move(e)}}(e),10);t.unbind("mouseup",i)};n=typeof n==="function"?n():n;if(!n){return}u.$("tooltip").html(n.replace(/\s/,"&#160;"));t.bind("mouseup",i)},define:function(t,n){if(typeof n!=="function"){var r=n;n=function(){return r}}t=e(t in u._dom?u.get(t):t).data("tt",n);d.show(t)}};var m=this._fullscreen={scrolled:0,crop:n,active:false,prev:e(),beforeEnter:function(e){e()},beforeExit:function(e){e()},keymap:u._keyboard.map,parseCallback:function(t,n){return j.active?function(){if(typeof t=="function"){t.call(u)}var r=u._controls.getActive(),i=u._controls.getNext();u._scaleImage(i);u._scaleImage(r);if(n&&u._options.trueFullscreen){e(r.container).add(i.container).trigger("transitionend")}}:t},enter:function(e){m.beforeEnter(function(){e=m.parseCallback(e,true);if(u._options.trueFullscreen&&L.support){m.active=true;H.forceStyles(u.get("container"),{width:"100%",height:"100%"});u.rescale();if(t.MAC){if(!(t.SAFARI&&/version\/[1-5]/.test(h))){u.$("container").css("opacity",0).addClass("fullscreen");r.setTimeout(function(){m.scale();u.$("container").css("opacity",1)},50)}else{u.$("stage").css("opacity",0);r.setTimeout(function(){m.scale();u.$("stage").css("opacity",1)},4)}}else{u.$("container").addClass("fullscreen")}o.resize(m.scale);L.enter(u,e,u.get("container"))}else{m.scrolled=o.scrollTop();if(!t.TOUCH){r.scrollTo(0,0)}m._enter(e)}})},_enter:function(s){m.active=true;if(w){m.iframe=function(){var n,s=i.referrer,o=i.createElement("a"),u=r.location;o.href=s;if(o.protocol!=u.protocol||o.hostname!=u.hostname||o.port!=u.port){t.raise("Parent fullscreen not available. Iframe protocol, domains and ports must match.");return false}m.pd=r.parent.document;e(m.pd).find("iframe").each(function(){var e=this.contentDocument||this.contentWindow.document;if(e===i){n=this;return false}});return n}()}H.hide(u.getActiveImage());if(w&&m.iframe){m.iframe.scrolled=e(r.parent).scrollTop();r.parent.scrollTo(0,0)}var a=u.getData(),f=u._options,l=!u._options.trueFullscreen||!L.support,c={height:"100%",overflow:"hidden",margin:0,padding:0};if(l){u.$("container").addClass("fullscreen");m.prev=u.$("container").prev();if(!m.prev.length){m.parent=u.$("container").parent()}u.$("container").appendTo("body");H.forceStyles(u.get("container"),{position:t.TOUCH?"absolute":"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1e4});H.forceStyles(b().html,c);H.forceStyles(b().body,c)}if(w&&m.iframe){H.forceStyles(m.pd.documentElement,c);H.forceStyles(m.pd.body,c);H.forceStyles(m.iframe,e.extend(c,{width:"100%",height:"100%",top:0,left:0,position:"fixed",zIndex:1e4,border:"none"}))}m.keymap=e.extend({},u._keyboard.map);u.attachKeyboard({escape:u.exitFullscreen,right:u.next,left:u.prev});m.crop=f.imageCrop;if(f.fullscreenCrop!=n){f.imageCrop=f.fullscreenCrop}if(a&&a.big&&a.image!==a.big){var h=new t.Picture,p=h.isCached(a.big),d=u.getIndex(),v=u._thumbnails[d];u.trigger({type:t.LOADSTART,cached:p,rewind:false,index:d,imageTarget:u.getActiveImage(),thumbTarget:v,galleriaData:a});h.load(a.big,function(n){u._scaleImage(n,{complete:function(n){u.trigger({type:t.LOADFINISH,cached:p,index:d,rewind:false,imageTarget:n.image,thumbTarget:v});var r=u._controls.getActive().image;if(r){e(r).width(n.image.width).height(n.image.height).attr("style",e(n.image).attr("style")).attr("src",n.image.src)}}})})}u.rescale(function(){u.addTimer(false,function(){if(l){H.show(u.getActiveImage())}if(typeof s==="function"){s.call(u)}u.rescale()},100);u.trigger(t.FULLSCREEN_ENTER)});if(!l){H.show(u.getActiveImage())}else{o.resize(m.scale)}},scale:function(){u.rescale()},exit:function(e){m.beforeExit(function(){e=m.parseCallback(e);if(u._options.trueFullscreen&&L.support){L.exit(e)}else{m._exit(e)}})},_exit:function(e){m.active=false;var n=!u._options.trueFullscreen||!L.support,i=u.$("container").removeClass("fullscreen");if(m.parent){m.parent.prepend(i)}else{i.insertAfter(m.prev)}if(n){H.hide(u.getActiveImage());H.revertStyles(u.get("container"),b().html,b().body);if(!t.TOUCH){r.scrollTo(0,m.scrolled)}var s=u._controls.frames[u._controls.active];if(s&&s.image){s.image.src=s.image.src}}if(w&&m.iframe){H.revertStyles(m.pd.documentElement,m.pd.body,m.iframe);if(m.iframe.scrolled){r.parent.scrollTo(0,m.iframe.scrolled)}}u.detachKeyboard();u.attachKeyboard(m.keymap);u._options.imageCrop=m.crop;var a=u.getData().big,f=u._controls.getActive().image;if(!u.getData().iframe&&f&&a&&a==f.src){r.setTimeout(function(e){return function(){f.src=e}}(u.getData().image),1)}u.rescale(function(){u.addTimer(false,function(){if(n){H.show(u.getActiveImage())}if(typeof e==="function"){e.call(u)}o.trigger("resize")},50);u.trigger(t.FULLSCREEN_EXIT)});o.unbind("resize",m.scale)}};var g=this._idle={trunk:[],bound:false,active:false,add:function(t,n,r,i){if(!t){return}if(!g.bound){g.addEvent()}t=e(t);if(typeof r=="boolean"){i=r;r={}}r=r||{};var s={},o;for(o in n){if(n.hasOwnProperty(o)){s[o]=t.css(o)}}t.data("idle",{from:e.extend(s,r),to:n,complete:true,busy:false});if(!i){g.addTimer()}else{t.css(n)}g.trunk.push(t)},remove:function(t){t=e(t);e.each(g.trunk,function(e,n){if(n&&n.length&&!n.not(t).length){t.css(t.data("idle").from);g.trunk.splice(e,1)}});if(!g.trunk.length){g.removeEvent();u.clearTimer(g.timer)}},addEvent:function(){g.bound=true;u.$("container").bind("mousemove click",g.showAll);if(u._options.idleMode=="hover"){u.$("container").bind("mouseleave",g.hide)}},removeEvent:function(){g.bound=false;u.$("container").bind("mousemove click",g.showAll);if(u._options.idleMode=="hover"){u.$("container").unbind("mouseleave",g.hide)}},addTimer:function(){if(u._options.idleMode=="hover"){return}u.addTimer("idle",function(){g.hide()},u._options.idleTime)},hide:function(){if(!u._options.idleMode||u.getIndex()===false){return}u.trigger(t.IDLE_ENTER);var n=g.trunk.length;e.each(g.trunk,function(e,t){var r=t.data("idle");if(!r){return}t.data("idle").complete=false;H.animate(t,r.to,{duration:u._options.idleSpeed,complete:function(){if(e==n-1){g.active=false}}})})},showAll:function(){u.clearTimer("idle");e.each(g.trunk,function(e,t){g.show(t)})},show:function(n){var r=n.data("idle");if(!g.active||!r.busy&&!r.complete){r.busy=true;u.trigger(t.IDLE_EXIT);u.clearTimer("idle");H.animate(n,r.from,{duration:u._options.idleSpeed/2,complete:function(){g.active=true;e(n).data("idle").busy=false;e(n).data("idle").complete=true}})}g.addTimer()}};var E=this._lightbox={width:0,height:0,initialized:false,active:null,image:null,elems:{},keymap:false,init:function(){if(E.initialized){return}E.initialized=true;var n="overlay box content shadow title info close prevholder prev nextholder next counter image",r={},i=u._options,s="",o="position:absolute;",a="lightbox-",f={overlay:"position:fixed;display:none;opacity:"+i.overlayOpacity+";filter:alpha(opacity="+i.overlayOpacity*100+");top:0;left:0;width:100%;height:100%;background:"+i.overlayBackground+";z-index:99990",box:"position:fixed;display:none;width:400px;height:400px;top:50%;left:50%;margin-top:-200px;margin-left:-200px;z-index:99991",shadow:o+"background:#000;width:100%;height:100%;",content:o+"background-color:#fff;top:10px;left:10px;right:10px;bottom:10px;overflow:hidden",info:o+"bottom:10px;left:10px;right:10px;color:#444;font:11px/13px arial,sans-serif;height:13px",close:o+"top:10px;right:10px;height:20px;width:20px;background:#fff;text-align:center;cursor:pointer;color:#444;font:16px/22px arial,sans-serif;z-index:99999",image:o+"top:10px;left:10px;right:10px;bottom:30px;overflow:hidden;display:block;",prevholder:o+"width:50%;top:0;bottom:40px;cursor:pointer;",nextholder:o+"width:50%;top:0;bottom:40px;right:-1px;cursor:pointer;",prev:o+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;left:20px;display:none;text-align:center;color:#000;font:bold 16px/36px arial,sans-serif",next:o+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;right:20px;left:auto;display:none;font:bold 16px/36px arial,sans-serif;text-align:center;color:#000",title:"float:left",counter:"float:right;margin-left:8px;"},l=function(t){return t.hover(function(){e(this).css("color","#bbb")},function(){e(this).css("color","#444")})},c={};if(y&&y>7){f.nextholder+="background:#000;filter:alpha(opacity=0);";f.prevholder+="background:#000;filter:alpha(opacity=0);"}e.each(f,function(e,t){s+=".galleria-"+a+e+"{"+t+"}"});s+=".galleria-"+a+"box.iframe .galleria-"+a+"prevholder,"+".galleria-"+a+"box.iframe .galleria-"+a+"nextholder{"+"width:100px;height:100px;top:50%;margin-top:-70px}";H.insertStyleTag(s,"galleria-lightbox");e.each(n.split(" "),function(e,t){u.addElement("lightbox-"+t);r[t]=E.elems[t]=u.get("lightbox-"+t)});E.image=new t.Picture;e.each({box:"shadow content close prevholder nextholder",info:"title counter",content:"info image",prevholder:"prev",nextholder:"next"},function(t,n){var r=[];e.each(n.split(" "),function(e,t){r.push(a+t)});c[a+t]=r});u.append(c);e(r.image).append(E.image.container);e(b().body).append(r.overlay,r.box);l(e(r.close).bind("click",E.hide).html("&#215;"));e.each(["Prev","Next"],function(n,i){var s=e(r[i.toLowerCase()]).html(/v/.test(i)?"&#8249;&#160;":"&#160;&#8250;"),o=e(r[i.toLowerCase()+"holder"]);o.bind("click",function(){E["show"+i]()});if(y<8||t.TOUCH){s.show();return}o.hover(function(){s.show()},function(e){s.stop().fadeOut(200)})});e(r.overlay).bind("click",E.hide);if(t.IPAD){u._options.lightboxTransitionSpeed=0}},rescale:function(n){var r=v.min(o.width()-40,E.width),i=v.min(o.height()-60,E.height),s=v.min(r/E.width,i/E.height),a=v.round(E.width*s)+40,f=v.round(E.height*s)+60,l={width:a,height:f,"margin-top":v.ceil(f/2)*-1,"margin-left":v.ceil(a/2)*-1};if(n){e(E.elems.box).css(l)}else{e(E.elems.box).animate(l,{duration:u._options.lightboxTransitionSpeed,easing:u._options.easing,complete:function(){var n=E.image,r=u._options.lightboxFadeSpeed;u.trigger({type:t.LIGHTBOX_IMAGE,imageTarget:n.image});e(n.container).show();e(n.image).animate({opacity:1},r);H.show(E.elems.info,r)}})}},hide:function(){E.image.image=null;o.unbind("resize",E.rescale);e(E.elems.box).hide().find("iframe").remove();H.hide(E.elems.info);u.detachKeyboard();u.attachKeyboard(E.keymap);E.keymap=false;H.hide(E.elems.overlay,200,function(){e(this).hide().css("opacity",u._options.overlayOpacity);u.trigger(t.LIGHTBOX_CLOSE)})},showNext:function(){E.show(u.getNext(E.active))},showPrev:function(){E.show(u.getPrev(E.active))},show:function(n){E.active=n=typeof n==="number"?n:u.getIndex()||0;if(!E.initialized){E.init()}u.trigger(t.LIGHTBOX_OPEN);if(!E.keymap){E.keymap=e.extend({},u._keyboard.map);u.attachKeyboard({escape:E.hide,right:E.showNext,left:E.showPrev})}o.unbind("resize",E.rescale);var i=u.getData(n),s=u.getDataLength(),a=u.getNext(n),f,l,c;H.hide(E.elems.info);try{for(c=u._options.preload;c>0;c--){l=new t.Picture;f=u.getData(a);l.preload(f.big?f.big:f.image);a=u.getNext(a)}}catch(h){}E.image.isIframe=i.iframe&&!i.image;e(E.elems.box).toggleClass("iframe",E.image.isIframe);e(E.image.container).find(".galleria-videoicon").remove();E.image.load(i.big||i.image||i.iframe,function(t){if(t.isIframe){var a=e(r).width(),f=e(r).height();if(t.video&&u._options.maxVideoSize){var l=v.min(u._options.maxVideoSize/a,u._options.maxVideoSize/f);if(l<1){a*=l;f*=l}}E.width=a;E.height=f}else{E.width=t.original.width;E.height=t.original.height}e(t.image).css({width:t.isIframe?"100%":"100.1%",height:t.isIframe?"100%":"100.1%",top:0,bottom:0,zIndex:99998,opacity:0,visibility:"visible"}).parent().height("100%");E.elems.title.innerHTML=i.title||"";E.elems.counter.innerHTML=n+1+" / "+s;o.resize(E.rescale);E.rescale();if(i.image&&i.iframe){e(E.elems.box).addClass("iframe");if(i.video){var c=B(t.container).hide();r.setTimeout(function(){c.fadeIn(200)},200)}e(t.image).css("cursor","pointer").mouseup(function(t,n){return function(r){e(E.image.container).find(".galleria-videoicon").remove();r.preventDefault();n.isIframe=true;n.load(t.iframe+(t.video?"&autoplay=1":""),{width:"100%",height:y<8?e(E.image.container).height():"100%"})}}(i,t))}});e(E.elems.overlay).show().css("visibility","visible");e(E.elems.box).show()}};var S=this._timer={trunk:{},add:function(e,t,n,i){e=e||(new Date).getTime();i=i||false;this.clear(e);if(i){var s=t;t=function(){s();S.add(e,t,n)}}this.trunk[e]=r.setTimeout(t,n)},clear:function(e){var t=function(e){r.clearTimeout(this.trunk[e]);delete this.trunk[e]},n;if(!!e&&e in this.trunk){t.call(this,e)}else if(typeof e==="undefined"){for(n in this.trunk){if(this.trunk.hasOwnProperty(n)){t.call(this,n)}}}}};return this};t.prototype={constructor:t,init:function(r,i){i=x(i);this._original={target:r,options:i,data:null};this._target=this._dom.target=r.nodeName?r:e(r).get(0);this._original.html=this._target.innerHTML;O.push(this);if(!this._target){t.raise("Target not found",true);return}this._options={autoplay:false,carousel:true,carouselFollow:true,carouselSpeed:400,carouselSteps:"auto",clicknext:false,dailymotion:{foreground:"%23EEEEEE",highlight:"%235BCEC5",background:"%23222222",logo:0,hideInfos:1},dataConfig:function(e){return{}},dataSelector:"img",dataSort:false,dataSource:this._target,debug:n,dummy:n,easing:"galleria",extend:function(e){},fullscreenCrop:n,fullscreenDoubleTap:true,fullscreenTransition:n,height:0,idleMode:true,idleTime:3e3,idleSpeed:200,imageCrop:false,imageMargin:0,imagePan:false,imagePanSmoothness:12,imagePosition:"50%",imageTimeout:n,initialTransition:n,keepSource:false,layerFollow:true,lightbox:false,lightboxFadeSpeed:200,lightboxTransitionSpeed:200,linkSourceImages:true,maxScaleRatio:n,maxVideoSize:n,minScaleRatio:n,overlayOpacity:.85,overlayBackground:"#0b0b0b",pauseOnInteraction:true,popupLinks:false,preload:2,queue:true,responsive:true,show:0,showInfo:true,showCounter:true,showImagenav:true,swipe:true,thumbCrop:true,thumbEventType:"click",thumbMargin:0,thumbQuality:"auto",thumbDisplayOrder:true,thumbPosition:"50%",thumbnails:true,touchTransition:n,transition:"fade",transitionInitial:n,transitionSpeed:400,trueFullscreen:true,useCanvas:false,variation:"",videoPoster:true,vimeo:{title:0,byline:0,portrait:0,color:"aaaaaa"},wait:5e3,width:"auto",youtube:{modestbranding:1,autohide:1,color:"white",hd:1,rel:0,showinfo:0}};this._options.initialTransition=this._options.initialTransition||this._options.transitionInitial;if(i&&i.debug===false){f=false}if(i&&typeof i.imageTimeout==="number"){l=i.imageTimeout}if(i&&typeof i.dummy==="string"){c=i.dummy}if(!t.TOUCH){this._options.swipe=false}e(this._target).children().hide();if(t.QUIRK){t.raise("Your page is in Quirks mode, Galleria may not render correctly. Please validate your HTML and add a correct doctype.")}if(typeof t.theme==="object"){this._init()}else{D.push(this)}return this},_init:function(){var s=this,u=this._options;if(this._initialized){t.raise("Init failed: Gallery instance already initialized.");return this}this._initialized=true;if(!t.theme){t.raise("Init failed: No theme found.",true);return this}e.extend(true,u,t.theme.defaults,this._original.options,t.configure.options);if(u.swipe){u.clicknext=false;u.imagePan=false}(function(e){if(!("getContext"in e)){e=null;return}_=_||{elem:e,context:e.getContext("2d"),cache:{},length:0}})(i.createElement("canvas"));t.Fastclick.init(this.get("target"));this.bind(t.DATA,function(){if(r.screen&&r.screen.width&&Array.prototype.forEach){this._data.forEach(function(e){var t="devicePixelRatio"in r?r.devicePixelRatio:1,n=v.max(r.screen.width,r.screen.height);if(n*t<1024){e.big=e.image}})}this._original.data=this._data;this.get("total").innerHTML=this.getDataLength();var e=this.$("container");if(s._options.height<2){s._userRatio=s._ratio=s._options.height}var n={width:0,height:0};var i=function(){return s.$("stage").height()};H.wait({until:function(){n=s._getWH();e.width(n.width).height(n.height);return i()&&n.width&&n.height>50},success:function(){s._width=n.width;s._height=n.height;s._ratio=s._ratio||n.height/n.width;if(t.WEBKIT){r.setTimeout(function(){s._run()},1)}else{s._run()}},error:function(){if(i()){t.raise("Could not extract sufficient width/height of the gallery container. Traced measures: width:"+n.width+"px, height: "+n.height+"px.",true)}else{t.raise("Could not extract a stage height from the CSS. Traced height: "+i()+"px.",true)}},timeout:typeof this._options.wait=="number"?this._options.wait:false})});this.append({"info-text":["info-title","info-description"],info:["info-text"],"image-nav":["image-nav-right","image-nav-left"],stage:["images","loader","counter","image-nav"],"thumbnails-list":["thumbnails"],"thumbnails-container":["thumb-nav-left","thumbnails-list","thumb-nav-right"],container:["stage","thumbnails-container","info","tooltip"]});H.hide(this.$("counter").append(this.get("current"),i.createTextNode(" / "),this.get("total")));this.setCounter("&#8211;");H.hide(s.get("tooltip"));this.$("container").addClass((t.TOUCH?"touch":"notouch")+" "+this._options.variation);if(!this._options.swipe){e.each(new Array(2),function(n){var r=new t.Picture;e(r.container).css({position:"absolute",top:0,left:0}).prepend(s._layers[n]=e(H.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]);s.$("images").append(r.container);s._controls[n]=r;var i=new t.Picture;i.isIframe=true;e(i.container).attr("class","galleria-frame").css({position:"absolute",top:0,left:0,zIndex:4,background:"#000",display:"none"}).appendTo(r.container);s._controls.frames[n]=i})}this.$("images").css({position:"relative",top:0,left:0,width:"100%",height:"100%"});if(u.swipe){this.$("images").css({position:"absolute",top:0,left:0,width:0,height:"100%"});this.finger=new t.Finger(this.get("stage"),{onchange:function(e){s.setCounter(e);s.pause();s.show(e)},oncomplete:function(e){var n=v.max(0,v.min(parseInt(e,10),s.getDataLength()-1)),r=s.getData(n);if(!r){return}s.$("images").find("iframe").remove();s.$("images").find(".galleria-frame").css("opacity",0).hide();var i=s.isFullscreen()&&r.big?r.big:r.image||r.iframe,o=s._controls.slides[n],u=o.isCached(i),a=s._thumbnails[n];s.trigger({type:t.IMAGE,cached:u,index:n,imageTarget:o.image,thumbTarget:a.image,galleriaData:r});if(s._options.carousel&&s._options.carouselFollow){s._carousel.follow(n)}}});this.bind(t.RESCALE,function(){this.finger.setup()});this.$("stage").bind("click",function(t){var i=s.getData();if(!i){return}if(i.iframe){if(s.isPlaying()){s.pause()}var o=s._controls.frames[s._active],u=s._stageWidth,a=s._stageHeight;if(e(o.container).find("iframe").length){return}e(o.container).css({width:u,height:a,opacity:0}).show().animate({opacity:1},200);r.setTimeout(function(){o.load(i.iframe+(i.video?"&autoplay=1":""),{width:u,height:a},function(e){s.$("container").addClass("videoplay");e.scale({width:s._stageWidth,height:s._stageHeight,iframelimit:i.video?s._options.maxVideoSize:n})})},100);return}if(i.link){if(s._options.popupLinks){var f=r.open(i.link,"_blank")}else{r.location.href=i.link}return}});this.bind(t.IMAGE,function(t){s.setCounter(t.index);s.setInfo(t.index);var n=this.getNext(),r=this.getPrev();var i=[r,n];i.push(this.getNext(n),this.getPrev(r),s._controls.slides.length-1);var o=[];e.each(i,function(t,n){if(e.inArray(n,o)==-1){o.push(n)}});e.each(o,function(t,n){var r=s.getData(n),i=s._controls.slides[n],o=s.isFullscreen()&&r.big?r.big:r.image||r.iframe;if(r.iframe&&!r.image){i.isIframe=true}if(!i.ready){s._controls.slides[n].load(o,function(t){if(!t.isIframe){e(t.image).css("visibility","hidden")}s._scaleImage(t,{complete:function(t){if(!t.isIframe){e(t.image).css({opacity:0,visibility:"visible"}).animate({opacity:1},200)}}})})}})})}this.$("thumbnails, thumbnails-list").css({overflow:"hidden",position:"relative"});this.$("image-nav-right, image-nav-left").bind("click",function(e){if(u.clicknext){e.stopPropagation()}if(u.pauseOnInteraction){s.pause()}var t=/right/.test(this.className)?"next":"prev";s[t]()});e.each(["info","counter","image-nav"],function(e,t){if(u["show"+t.substr(0,1).toUpperCase()+t.substr(1).replace(/-/,"")]===false){H.moveOut(s.get(t.toLowerCase()))}});this.load();if(!u.keepSource&&!y){this._target.innerHTML=""}if(this.get("errors")){this.appendChild("target","errors")}this.appendChild("target","container");if(u.carousel){var a=0,f=u.show;this.bind(t.THUMBNAIL,function(){this.updateCarousel();if(++a==this.getDataLength()&&typeof f=="number"&&f>0){this._carousel.follow(f)}})}if(u.responsive){o.bind("resize",function(){if(!s.isFullscreen()){s.resize()}})}if(u.fullscreenDoubleTap){this.$("stage").bind("touchstart",function(){var e,t,n,r,i,o,u=function(e){return e.originalEvent.touches?e.originalEvent.touches[0]:e};s.$("stage").bind("touchmove",function(){e=0});return function(a){if(/(-left|-right)/.test(a.target.className)){return}o=H.timestamp();t=u(a).pageX;n=u(a).pageY;if(a.originalEvent.touches.length<2&&o-e<300&&t-r<20&&n-i<20){s.toggleFullscreen();a.preventDefault();return}e=o;r=t;i=n}}())}e.each(t.on.binds,function(t,n){if(e.inArray(n.hash,s._binds)==-1){s.bind(n.type,n.callback)}});return this},addTimer:function(){this._timer.add.apply(this._timer,H.array(arguments));return this},clearTimer:function(){this._timer.clear.apply(this._timer,H.array(arguments));return this},_getWH:function(){var t=this.$("container"),n=this.$("target"),r=this,i={},s;e.each(["width","height"],function(e,o){if(r._options[o]&&typeof r._options[o]==="number"){i[o]=r._options[o]}else{s=[H.parseValue(t.css(o)),H.parseValue(n.css(o)),t[o](),n[o]()];if(!r["_"+o]){s.splice(s.length,H.parseValue(t.css("min-"+o)),H.parseValue(n.css("min-"+o)))}i[o]=v.max.apply(v,s)}});if(r._userRatio){i.height=i.width*r._userRatio}return i},_createThumbnails:function(n){this.get("total").innerHTML=this.getDataLength();var s,o,u,a,f=this,l=this._options,c=n?this._data.length-n.length:0,h=c,p=[],d=0,v=y<8?"http://upload.wikimedia.org/wikipedia/commons/c/c0/Blank.gif":"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw%3D%3D",m=function(){var e=f.$("thumbnails").find(".active");if(!e.length){return false}return e.find("img").attr("src")}(),g=typeof l.thumbnails==="string"?l.thumbnails.toLowerCase():null,b=function(e){return i.defaultView&&i.defaultView.getComputedStyle?i.defaultView.getComputedStyle(o.container,null)[e]:a.css(e)},w=function(n,r,i){return function(){e(i).append(n);f.trigger({type:t.THUMBNAIL,thumbTarget:n,index:r,galleriaData:f.getData(r)})}},E=function(t){if(l.pauseOnInteraction){f.pause()}var n=e(t.currentTarget).data("index");if(f.getIndex()!==n){f.show(n)}t.preventDefault()},S=function(n,r){e(n.container).css("visibility","visible");f.trigger({type:t.THUMBNAIL,thumbTarget:n.image,index:n.data.order,galleriaData:f.getData(n.data.order)});if(typeof r=="function"){r.call(f,n)}},x=function(t,n){t.scale({width:t.data.width,height:t.data.height,crop:l.thumbCrop,margin:l.thumbMargin,canvas:l.useCanvas,position:l.thumbPosition,complete:function(t){var r=["left","top"],i=["Width","Height"],s,o,u=f.getData(t.index);e.each(i,function(n,i){s=i.toLowerCase();if(l.thumbCrop!==true||l.thumbCrop===s){o={};o[s]=t[s];e(t.container).css(o);o={};o[r[n]]=0;e(t.image).css(o)}t["outer"+i]=e(t.container)["outer"+i](true)});H.toggleQuality(t.image,l.thumbQuality===true||l.thumbQuality==="auto"&&t.original.width<t.width*3);if(l.thumbDisplayOrder&&!t.lazy){e.each(p,function(e,t){if(e===d&&t.ready&&!t.displayed){d++;t.displayed=true;S(t,n);return}})}else{S(t,n)}}})};if(!n){this._thumbnails=[];this.$("thumbnails").empty()}for(;this._data[c];c++){u=this._data[c];s=u.thumb||u.image;if((l.thumbnails===true||g=="lazy")&&(u.thumb||u.image)){o=new t.Picture(c);o.index=c;o.displayed=false;o.lazy=false;o.video=false;this.$("thumbnails").append(o.container);a=e(o.container);a.css("visibility","hidden");o.data={width:H.parseValue(b("width")),height:H.parseValue(b("height")),order:c,src:s};if(l.thumbCrop!==true){a.css({width:"auto",height:"auto"})}else{a.css({width:o.data.width,height:o.data.height})}if(g=="lazy"){a.addClass("lazy");o.lazy=true;o.load(v,{height:o.data.height,width:o.data.width})}else{o.load(s,x)}if(l.preload==="all"){o.preload(u.image)}}else if(u.iframe||g==="empty"||g==="numbers"){o={container:H.create("galleria-image"),image:H.create("img","span"),ready:true,data:{order:c}};if(g==="numbers"){e(o.image).text(c+1)}if(u.iframe){e(o.image).addClass("iframe")}this.$("thumbnails").append(o.container);r.setTimeout(w(o.image,c,o.container),50+c*20)}else{o={container:null,image:null}}e(o.container).add(l.keepSource&&l.linkSourceImages?u.original:null).data("index",c).bind(l.thumbEventType,E).data("thumbload",x);if(m===s){e(o.container).addClass("active")}this._thumbnails.push(o)}p=this._thumbnails.slice(h);return this},lazyLoad:function(t,n){var r=t.constructor==Array?t:[t],i=this,s=0;e.each(r,function(t,o){if(o>i._thumbnails.length-1){return}var u=i._thumbnails[o],a=u.data,f=function(){if(++s==r.length&&typeof n=="function"){n.call(i)}},l=e(u.container).data("thumbload");if(u.video){l.call(i,u,f)}else{u.load(a.src,function(e){l.call(i,e,f)})}});return this},lazyLoadChunks:function(e,t){var n=this.getDataLength(),i=0,s=0,o=[],u=[],a=this;t=t||0;for(;i<n;i++){u.push(i);if(++s==e||i==n-1){o.push(u);s=0;u=[]}}var f=function(e){var n=o.shift();if(n){r.setTimeout(function(){a.lazyLoad(n,function(){f(true)})},t&&e?t:0)}};f(false);return this},_run:function(){var i=this;i._createThumbnails();H.wait({timeout:1e4,until:function(){if(t.OPERA){i.$("stage").css("display","inline-block")}i._stageWidth=i.$("stage").width();i._stageHeight=i.$("stage").height();return i._stageWidth&&i._stageHeight>50},success:function(){A.push(i);if(i._options.swipe){var s=i.$("images").width(i.getDataLength()*i._stageWidth);e.each(new Array(i.getDataLength()),function(n){var r=new t.Picture,o=i.getData(n);e(r.container).css({position:"absolute",top:0,left:i._stageWidth*n}).prepend(i._layers[n]=e(H.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]).appendTo(s);if(o.video){B(r.container)}i._controls.slides.push(r);var u=new t.Picture;u.isIframe=true;e(u.container).attr("class","galleria-frame").css({position:"absolute",top:0,left:0,zIndex:4,background:"#000",display:"none"}).appendTo(r.container);i._controls.frames.push(u)});i.finger.setup()}H.show(i.get("counter"));if(i._options.carousel){i._carousel.bindControls()}if(i._options.autoplay){i.pause();if(typeof i._options.autoplay==="number"){i._playtime=i._options.autoplay}i._playing=true}if(i._firstrun){if(i._options.autoplay){i.trigger(t.PLAY)}if(typeof i._options.show==="number"){i.show(i._options.show)}return}i._firstrun=true;if(t.History){t.History.change(function(e){if(isNaN(e)){r.history.go(-1)}else{i.show(e,n,true)}})}i.trigger(t.READY);t.theme.init.call(i,i._options);e.each(t.ready.callbacks,function(e,t){if(typeof t=="function"){t.call(i,i._options)}});t.ready.callbacks=[];i._options.extend.call(i,i._options);if(/^[0-9]{1,4}$/.test(p)&&t.History){i.show(p,n,true)}else if(i._data[i._options.show]){i.show(i._options.show)}if(i._options.autoplay){i.trigger(t.PLAY)}},error:function(){t.raise("Stage width or height is too small to show the gallery. Traced measures: width:"+i._stageWidth+"px, height: "+i._stageHeight+"px.",true)}})},load:function(n,r,i){var s=this,o=this._options;this._data=[];this._thumbnails=[];this.$("thumbnails").empty();if(typeof r==="function"){i=r;r=null}n=n||o.dataSource;r=r||o.dataSelector;i=i||o.dataConfig;if(e.isPlainObject(n)){n=[n]}if(e.isArray(n)){if(this.validate(n)){this._data=n}else{t.raise("Load failed: JSON Array not valid.")}}else{r+=",.video,.iframe";e(n).find(r).each(function(t,n){n=e(n);var r={},o=n.parent(),u=o.attr("href"),a=o.attr("rel");if(u&&(n[0].nodeName=="IMG"||n.hasClass("video"))&&k(u)){r.video=u}else if(u&&n.hasClass("iframe")){r.iframe=u}else{r.image=r.big=u}if(a){r.big=a}e.each("big title description link layer image".split(" "),function(e,t){if(n.data(t)){r[t]=n.data(t).toString()}});if(!r.big){r.big=r.image}s._data.push(e.extend({title:n.attr("title")||"",thumb:n.attr("src"),image:n.attr("src"),big:n.attr("src"),description:n.attr("alt")||"",link:n.attr("longdesc"),original:n.get(0)},r,i(n)))})}if(typeof o.dataSort=="function"){u.sort.call(this._data,o.dataSort)}else if(o.dataSort=="random"){this._data.sort(function(){return v.round(v.random())-.5})}if(this.getDataLength()){this._parseData(function(){this.trigger(t.DATA)})}return this},_parseData:function(t){var r=this,i,s=false,o=function(){var n=true;e.each(r._data,function(e,t){if(t.loading){n=false;return false}});if(n&&!s){s=true;t.call(r)}};e.each(this._data,function(t,s){i=r._data[t];if("thumb"in s===false){i.thumb=s.image}if(!s.big){i.big=s.image}if("video"in s){var u=k(s.video);if(u){i.iframe=(new C(u.provider,u.id)).embed()+function(){if(typeof r._options[u.provider]=="object"){var t="?",n=[];e.each(r._options[u.provider],function(e,t){n.push(e+"="+t)});if(u.provider=="youtube"){n=["wmode=opaque"].concat(n)}return t+n.join("&")}return""}();if(!i.thumb||!i.image){e.each(["thumb","image"],function(e,t){if(t=="image"&&!r._options.videoPoster){i.image=n;return}var s=new C(u.provider,u.id);if(!i[t]){i.loading=true;s.getMedia(t,function(e,t){return function(n){e[t]=n;if(t=="image"&&!e.big){e.big=e.image}delete e.loading;o()}}(i,t))}})}}}});o();return this},destroy:function(){this.$("target").data("galleria",null);this.$("container").unbind("galleria");this.get("target").innerHTML=this._original.html;this.clearTimer();H.removeFromArray(O,this);H.removeFromArray(A,this);if(t._waiters.length){e.each(t._waiters,function(e,t){if(t)r.clearTimeout(t)})}return this},splice:function(){var e=this,t=H.array(arguments);r.setTimeout(function(){u.splice.apply(e._data,t);e._parseData(function(){e._createThumbnails()})},2);return e},push:function(){var e=this,t=H.array(arguments);if(t.length==1&&t[0].constructor==Array){t=t[0]}r.setTimeout(function(){u.push.apply(e._data,t);e._parseData(function(){e._createThumbnails(t)})},2);return e},_getActive:function(){return this._controls.getActive()},validate:function(e){return true},bind:function(e,t){e=T(e);this.$("container").bind(e,this.proxy(t));return this},unbind:function(e){e=T(e);this.$("container").unbind(e);return this},trigger:function(t){t=typeof t==="object"?e.extend(t,{scope:this}):{type:T(t),scope:this};this.$("container").trigger(t);return this},addIdleState:function(e,t,n,r){this._idle.add.apply(this._idle,H.array(arguments));return this},removeIdleState:function(e){this._idle.remove.apply(this._idle,H.array(arguments));return this},enterIdleMode:function(){this._idle.hide();return this},exitIdleMode:function(){this._idle.showAll();return this},enterFullscreen:function(e){this._fullscreen.enter.apply(this,H.array(arguments));return this},exitFullscreen:function(e){this._fullscreen.exit.apply(this,H.array(arguments));return this},toggleFullscreen:function(e){this._fullscreen[this.isFullscreen()?"exit":"enter"].apply(this,H.array(arguments));return this},bindTooltip:function(e,t){this._tooltip.bind.apply(this._tooltip,H.array(arguments));return this},defineTooltip:function(e,t){this._tooltip.define.apply(this._tooltip,H.array(arguments));return this},refreshTooltip:function(e){this._tooltip.show.apply(this._tooltip,H.array(arguments));return this},openLightbox:function(){this._lightbox.show.apply(this._lightbox,H.array(arguments));return this},closeLightbox:function(){this._lightbox.hide.apply(this._lightbox,H.array(arguments));return this},hasVariation:function(t){return e.inArray(t,this._options.variation.split(/\s+/))>-1},getActiveImage:function(){var e=this._getActive();return e?e.image:n},getActiveThumb:function(){return this._thumbnails[this._active].image||n},getMousePosition:function(e){return{x:e.pageX-this.$("container").offset().left,y:e.pageY-this.$("container").offset().top}},addPan:function(t){if(this._options.imageCrop===false){return}t=e(t||this.getActiveImage());var n=this,r=t.width()/2,i=t.height()/2,s=parseInt(t.css("left"),10),o=parseInt(t.css("top"),10),u=s||0,a=o||0,f=0,l=0,c=false,h=H.timestamp(),p=0,d=0,m=function(e,n,r){if(e>0){d=v.round(v.max(e*-1,v.min(0,n)));if(p!==d){p=d;if(y===8){t.parent()["scroll"+r](d*-1)}else{var i={};i[r.toLowerCase()]=d;t.css(i)}}}},g=function(e){if(H.timestamp()-h<50){return}c=true;r=n.getMousePosition(e).x;i=n.getMousePosition(e).y},b=function(e){if(!c){return}f=t.width()-n._stageWidth;l=t.height()-n._stageHeight;s=r/n._stageWidth*f*-1;o=i/n._stageHeight*l*-1;u+=(s-u)/n._options.imagePanSmoothness;a+=(o-a)/n._options.imagePanSmoothness;m(l,a,"Top");m(f,u,"Left")};if(y===8){t.parent().scrollTop(a*-1).scrollLeft(u*-1);t.css({top:0,left:0})}this.$("stage").unbind("mousemove",g).bind("mousemove",g);this.addTimer("pan"+n._id,b,50,true);return this},proxy:function(e,t){if(typeof e!=="function"){return m}t=t||this;return function(){return e.apply(t,H.array(arguments))}},removePan:function(){this.$("stage").unbind("mousemove");this.clearTimer("pan"+this._id);return this},addElement:function(t){var n=this._dom;e.each(H.array(arguments),function(e,t){n[t]=H.create("galleria-"+t)});return this},attachKeyboard:function(e){this._keyboard.attach.apply(this._keyboard,H.array(arguments));return this},detachKeyboard:function(){this._keyboard.detach.apply(this._keyboard,H.array(arguments));return this},appendChild:function(e,t){this.$(e).append(this.get(t)||t);return this},prependChild:function(e,t){this.$(e).prepend(this.get(t)||t);return this},remove:function(e){this.$(H.array(arguments).join(",")).remove();return this},append:function(e){var t,n;for(t in e){if(e.hasOwnProperty(t)){if(e[t].constructor===Array){for(n=0;e[t][n];n++){this.appendChild(t,e[t][n])}}else{this.appendChild(t,e[t])}}}return this},_scaleImage:function(t,n){t=t||this._controls.getActive();if(!t){return}var r,i=function(t){e(t.container).children(":first").css({top:v.max(0,H.parseValue(t.image.style.top)),left:v.max(0,H.parseValue(t.image.style.left)),width:H.parseValue(t.image.width),height:H.parseValue(t.image.height)})};n=e.extend({width:this._stageWidth,height:this._stageHeight,crop:this._options.imageCrop,max:this._options.maxScaleRatio,min:this._options.minScaleRatio,margin:this._options.imageMargin,position:this._options.imagePosition,iframelimit:this._options.maxVideoSize},n);if(this._options.layerFollow&&this._options.imageCrop!==true){if(typeof n.complete=="function"){r=n.complete;n.complete=function(){r.call(t,t);i(t)}}else{n.complete=i}}else{e(t.container).children(":first").css({top:0,left:0})}t.scale(n);return this},updateCarousel:function(){this._carousel.update();return this},resize:function(t,r){if(typeof t=="function"){r=t;t=n}t=e.extend({width:0,height:0},t);var i=this,s=this.$("container");e.each(t,function(e,n){if(!n){s[e]("auto");t[e]=i._getWH()[e]}});e.each(t,function(e,t){s[e](t)});return this.rescale(r)},rescale:function(r,i,s){var o=this;if(typeof r==="function"){s=r;r=n}var u=function(){o._stageWidth=r||o.$("stage").width();o._stageHeight=i||o.$("stage").height();if(o._options.swipe){e.each(o._controls.slides,function(t,n){o._scaleImage(n);e(n.container).css("left",o._stageWidth*t)});o.$("images").css("width",o._stageWidth*o.getDataLength())}else{o._scaleImage()}if(o._options.carousel){o.updateCarousel()}o._controls.frames[o._controls.active].scale({width:o._stageWidth,height:o._stageHeight,iframelimit:o._options.maxVideoSize});o.trigger(t.RESCALE);if(typeof s==="function"){s.call(o)}};u.call(o);return this},refreshImage:function(){this._scaleImage();if(this._options.imagePan){this.addPan()}return this},show:function(n,i,s){var o=this._options.swipe;if(!o&&(this._queue.length>3||n===false||!this._options.queue&&this._queue.stalled)){return}n=v.max(0,v.min(parseInt(n,10),this.getDataLength()-1));i=typeof i!=="undefined"?!!i:n<this.getIndex();s=s||false;if(!s&&t.History){t.History.set(n.toString());return}if(this.finger&&n!==this._active){this.finger.to=-(n*this.finger.width);this.finger.index=n}this._active=n;if(o){var a=this.getData(n),f=this;if(!a){return}var l=this.isFullscreen()&&a.big?a.big:a.image||a.iframe,c=this._controls.slides[n],h=c.isCached(l),p=this._thumbnails[n];var d={cached:h,index:n,rewind:i,imageTarget:c.image,thumbTarget:p.image,galleriaData:a};this.trigger(e.extend(d,{type:t.LOADSTART}));e(f._thumbnails[n].container).addClass("active").siblings(".active").removeClass("active");f.$("container").removeClass("videoplay");var m=function(){f._layers[n].innerHTML=f.getData().layer||"";f.trigger(e.extend(d,{type:t.LOADFINISH}));f._playCheck()};r.setTimeout(function(){if(!c.ready){if(a.iframe&&!a.image){c.isIframe=true}c.load(l,function(n){f._scaleImage(n,m).trigger(e.extend(d,{type:t.IMAGE}));m()})}else{f.trigger(e.extend(d,{type:t.IMAGE}));m()}},800)}else{u.push.call(this._queue,{index:n,rewind:i});if(!this._queue.stalled){this._show()}}return this},_show:function(){var i=this,s=this._queue[0],o=this.getData(s.index);if(!o){return}var a=this.isFullscreen()&&o.big?o.big:o.image||o.iframe,f=this._controls.getActive(),l=this._controls.getNext(),c=l.isCached(a),h=this._thumbnails[s.index],p=function(){e(l.image).trigger("mouseup")};i.$("container").toggleClass("iframe",!!o.isIframe).removeClass("videoplay");var d=function(s,o,a,f,l){return function(){var c;j.active=false;H.toggleQuality(o.image,i._options.imageQuality);i._layers[i._controls.active].innerHTML="";e(a.container).css({zIndex:0,opacity:0}).show();e(a.container).find("iframe, .galleria-videoicon").remove();e(i._controls.frames[i._controls.active].container).hide();e(o.container).css({zIndex:1,left:0,top:0}).show();i._controls.swap();if(i._options.imagePan){i.addPan(o.image)}if(s.iframe&&s.image||s.link||i._options.lightbox||i._options.clicknext){e(o.image).css({cursor:"pointer"}).bind("mouseup",function(o){if(typeof o.which=="number"&&o.which>1){return}if(s.iframe){if(i.isPlaying()){i.pause()}var u=i._controls.frames[i._controls.active],a=i._stageWidth,f=i._stageHeight;e(u.container).css({width:a,height:f,opacity:0}).show().animate({opacity:1},200);r.setTimeout(function(){u.load(s.iframe+(s.video?"&autoplay=1":""),{width:a,height:f},function(e){i.$("container").addClass("videoplay");e.scale({width:i._stageWidth,height:i._stageHeight,iframelimit:s.video?i._options.maxVideoSize:n})})},100);return}if(i._options.clicknext&&!t.TOUCH){if(i._options.pauseOnInteraction){i.pause()}i.next();return}if(s.link){if(i._options.popupLinks){c=r.open(s.link,"_blank")}else{r.location.href=s.link}return}if(i._options.lightbox){i.openLightbox()}})}i._playCheck();i.trigger({type:t.IMAGE,index:f.index,imageTarget:o.image,thumbTarget:l.image,galleriaData:s});u.shift.call(i._queue);i._queue.stalled=false;if(i._queue.length){i._show()}}}(o,l,f,s,h);if(this._options.carousel&&this._options.carouselFollow){this._carousel.follow(s.index)}if(this._options.preload){var v,m,g=this.getNext(),y;try{for(m=this._options.preload;m>0;m--){v=new t.Picture;y=i.getData(g);v.preload(this.isFullscreen()&&y.big?y.big:y.image);g=i.getNext(g)}}catch(b){}}H.show(l.container);l.isIframe=o.iframe&&!o.image;e(i._thumbnails[s.index].container).addClass("active").siblings(".active").removeClass("active");i.trigger({type:t.LOADSTART,cached:c,index:s.index,rewind:s.rewind,imageTarget:l.image,thumbTarget:h.image,galleriaData:o});i._queue.stalled=true;l.load(a,function(r){var u=e(i._layers[1-i._controls.active]).html(o.layer||"").hide();i._scaleImage(r,{complete:function(r){if("image"in f){H.toggleQuality(f.image,false)}H.toggleQuality(r.image,false);i.removePan();i.setInfo(s.index);i.setCounter(s.index);if(o.layer){u.show();if(o.iframe&&o.image||o.link||i._options.lightbox||i._options.clicknext){u.css("cursor","pointer").unbind("mouseup").mouseup(p)}}if(o.video&&o.image){B(r.container)}var a=i._options.transition;e.each({initial:f.image===null,touch:t.TOUCH,fullscreen:i.isFullscreen()},function(e,t){if(t&&i._options[e+"Transition"]!==n){a=i._options[e+"Transition"];return false}});if(a in j.effects===false){d()}else{var l={prev:f.container,next:r.container,rewind:s.rewind,speed:i._options.transitionSpeed||400};j.active=true;j.init.call(i,a,l,d)}i.trigger({type:t.LOADFINISH,cached:c,index:s.index,rewind:s.rewind,imageTarget:r.image,thumbTarget:i._thumbnails[s.index].image,galleriaData:i.getData(s.index)})}})})},getNext:function(e){e=typeof e==="number"?e:this.getIndex();return e===this.getDataLength()-1?0:e+1},getPrev:function(e){e=typeof e==="number"?e:this.getIndex();return e===0?this.getDataLength()-1:e-1},next:function(){if(this.getDataLength()>1){this.show(this.getNext(),false)}return this},prev:function(){if(this.getDataLength()>1){this.show(this.getPrev(),true)}return this},get:function(e){return e in this._dom?this._dom[e]:null},getData:function(e){return e in this._data?this._data[e]:this._data[this._active]},getDataLength:function(){return this._data.length},getIndex:function(){return typeof this._active==="number"?this._active:false},getStageHeight:function(){return this._stageHeight},getStageWidth:function(){return this._stageWidth},getOptions:function(e){return typeof e==="undefined"?this._options:this._options[e]},setOptions:function(t,n){if(typeof t==="object"){e.extend(this._options,t)}else{this._options[t]=n}return this},play:function(e){this._playing=true;this._playtime=e||this._playtime;this._playCheck();this.trigger(t.PLAY);return this},pause:function(){this._playing=false;this.trigger(t.PAUSE);return this},playToggle:function(e){return this._playing?this.pause():this.play(e)},isPlaying:function(){return this._playing},isFullscreen:function(){return this._fullscreen.active},_playCheck:function(){var e=this,n=0,r=20,i=H.timestamp(),s="play"+this._id;if(this._playing){this.clearTimer(s);var o=function(){n=H.timestamp()-i;if(n>=e._playtime&&e._playing){e.clearTimer(s);e.next();return}if(e._playing){e.trigger({type:t.PROGRESS,percent:v.ceil(n/e._playtime*100),seconds:v.floor(n/1e3),milliseconds:n});e.addTimer(s,o,r)}};e.addTimer(s,o,r)}},setPlaytime:function(e){this._playtime=e;return this},setIndex:function(e){this._active=e;return this},setCounter:function(e){if(typeof e==="number"){e++}else if(typeof e==="undefined"){e=this.getIndex()+1}this.get("current").innerHTML=e;if(y){var t=this.$("counter"),n=t.css("opacity");if(parseInt(n,10)===1){H.removeAlpha(t[0])}else{this.$("counter").css("opacity",n)}}return this},setInfo:function(t){var n=this,r=this.getData(t);e.each(["title","description"],function(e,t){var i=n.$("info-"+t);if(!!r[t]){i[r[t].length?"show":"hide"]().html(r[t])}else{i.empty().hide()}});return this},hasInfo:function(e){var t="title description".split(" "),n;for(n=0;t[n];n++){if(!!this.getData(e)[t[n]]){return true}}return false},jQuery:function(t){var n=this,r=[];e.each(t.split(","),function(t,i){i=e.trim(i);if(n.get(i)){r.push(i)}});var i=e(n.get(r.shift()));e.each(r,function(e,t){i=i.add(n.get(t))});return i},$:function(e){return this.jQuery.apply(this,H.array(arguments))}};e.each(S,function(e,n){var r=/_/.test(n)?n.replace(/_/g,""):n;t[n.toUpperCase()]="galleria."+r});e.extend(t,{IE9:y===9,IE8:y===8,IE7:y===7,IE6:y===6,IE:y,WEBKIT:/webkit/.test(h),CHROME:/chrome/.test(h),SAFARI:/safari/.test(h)&&!/chrome/.test(h),QUIRK:y&&i.compatMode&&i.compatMode==="BackCompat",MAC:/mac/.test(navigator.platform.toLowerCase()),OPERA:!!r.opera,IPHONE:/iphone/.test(h),IPAD:/ipad/.test(h),ANDROID:/android/.test(h),TOUCH:"ontouchstart"in i});t.addTheme=function(n){if(!n.name){t.raise("No theme name specified")}if(typeof n.defaults!=="object"){n.defaults={}}else{n.defaults=x(n.defaults)}var i=false,s;if(typeof n.css==="string"){e("link").each(function(e,t){s=new RegExp(n.css);if(s.test(t.href)){i=true;P(n);return false}});if(!i){e(function(){e("script").each(function(e,t){s=new RegExp("galleria\\."+n.name.toLowerCase()+"\\.");if(s.test(t.src)){i=t.src.replace(/[^\/]*$/,"")+n.css;r.setTimeout(function(){H.loadCSS(i,"galleria-theme",function(){P(n)})},1)}});if(!i){t.raise("No theme CSS loaded")}})}}else{P(n)}return n};t.loadTheme=function(n,i){if(e("script").filter(function(){return e(this).attr("src")==n}).length){return}var s=false,o;e(r).load(function(){if(!s){o=r.setTimeout(function(){if(!s&&!t.theme){t.raise("Galleria had problems loading theme at "+n+". Please check theme path or load manually.",true)}},2e4)}});t.unloadTheme();H.loadScript(n,function(){s=true;r.clearTimeout(o)});return t};t.unloadTheme=function(){if(typeof t.theme=="object"){e("script").each(function(n,r){if((new RegExp("galleria\\."+t.theme.name+"\\.")).test(r.src)){e(r).remove()}});t.theme=n}return t};t.get=function(e){if(!!O[e]){return O[e]}else if(typeof e!=="number"){return O}else{t.raise("Gallery index "+e+" not found")}};t.configure=function(n,r){var i={};if(typeof n=="string"&&r){i[n]=r;n=i}else{e.extend(i,n)}t.configure.options=i;e.each(t.get(),function(e,t){t.setOptions(i)});return t};t.configure.options={};t.on=function(n,r){if(!n){return}r=r||m;var i=n+r.toString().replace(/\s/g,"")+H.timestamp();e.each(t.get(),function(e,t){t._binds.push(i);t.bind(n,r)});t.on.binds.push({type:n,callback:r,hash:i});return t};t.on.binds=[];t.run=function(n,r){if(e.isFunction(r)){r={extend:r}}e(n||"#galleria").galleria(r);return t};t.addTransition=function(e,n){j.effects[e]=n;return t};t.utils=H;t.log=function(){var t=H.array(arguments);if("console"in r&&"log"in r.console){try{return r.console.log.apply(r.console,t)}catch(n){e.each(t,function(){r.console.log(this)})}}else{return r.alert(t.join("<br>"))}};t.ready=function(n){if(typeof n!="function"){return t}e.each(A,function(e,t){n.call(t,t._options)});t.ready.callbacks.push(n);return t};t.ready.callbacks=[];t.raise=function(t,n){var r=n?"Fatal error":"Error",i={color:"#fff",position:"absolute",top:0,left:0,zIndex:1e5},s=function(t){var s='<div style="padding:4px;margin:0 0 2px;background:#'+(n?"811":"222")+';">'+(n?"<strong>"+r+": </strong>":"")+t+"</div>";e.each(O,function(){var e=this.$("errors"),t=this.$("target");if(!e.length){t.css("position","relative");e=this.addElement("errors").appendChild("target","errors").$("errors").css(i)}e.append(s)});if(!O.length){e("<div>").css(e.extend(i,{position:"fixed"})).append(s).appendTo(b().body)}};if(f){s(t);if(n){throw new Error(r+": "+t)}}else if(n){if(M){return}M=true;n=false;s("Gallery could not load.")}};t.version=a;t.requires=function(e,n){n=n||"You need to upgrade Galleria to version "+e+" to use one or more components.";if(t.version<e){t.raise(n,true)}return t};t.Picture=function(t){this.id=t||null;this.image=null;this.container=H.create("galleria-image");e(this.container).css({overflow:"hidden",position:"relative"});this.original={width:0,height:0};this.ready=false;this.isIframe=false};t.Picture.prototype={cache:{},show:function(){H.show(this.image)},hide:function(){H.moveOut(this.image)},clear:function(){this.image=null},isCached:function(e){return!!this.cache[e]},preload:function(t){e(new Image).load(function(e,t){return function(){t[e]=e}}(t,this.cache)).attr("src",t)},load:function(n,i,s){if(typeof i=="function"){s=i;i=null}if(this.isIframe){var o="if"+(new Date).getTime();var u=this.image=e("<iframe>",{src:n,frameborder:0,id:o,allowfullscreen:true,css:{visibility:"hidden"}})[0];if(i){e(u).css(i)}e(this.container).find("iframe,img").remove();this.container.appendChild(this.image);e("#"+o).load(function(t,n){return function(){r.setTimeout(function(){e(t.image).css("visibility","visible");if(typeof n=="function"){n.call(t,t)}},10)}}(this,s));return this.container}this.image=new Image;if(t.IE8){e(this.image).css("filter","inherit")}var a=false,f=false,l=e(this.container),h=e(this.image),p=function(){if(!a){a=true;r.setTimeout(function(e,t){return function(){e.attr("src",t+"?"+H.timestamp())}}(e(this),n),50)}else{if(c){e(this).attr("src",c)}else{t.raise("Image not found: "+n)}}},d=function(n,s,o){return function(){var u=function(){e(this).unbind("load");n.original=i||{height:this.height,width:this.width};if(t.HAS3D){this.style.MozTransform=this.style.webkitTransform="translate3d(0,0,0)"}l.append(this);n.cache[o]=o;if(typeof s=="function"){r.setTimeout(function(){s.call(n,n)},1)}};if(!this.width||!this.height){r.setTimeout(function(n){return function(){if(n.width&&n.height){u.call(n)}else{if(!f){e(new Image).load(d).attr("src",n.src);f=true}else{t.raise("Could not extract width/height from image: "+n.src+". Traced measures: width:"+n.width+"px, height: "+n.height+"px.")}}}}(this),2)}else{u.call(this)}}}(this,s,n);l.find("iframe,img").remove();h.css("display","block");H.hide(this.image);e.each("minWidth minHeight maxWidth maxHeight".split(" "),function(e,t){h.css(t,/min/.test(t)?"0":"none")});h.load(d).bind("error",p).attr("src",n);return this.container},scale:function(r){var i=this;r=e.extend({width:0,height:0,min:n,max:n,margin:0,complete:m,position:"center",crop:false,canvas:false,iframelimit:n},r);if(this.isIframe){var s=r.width,o=r.height,u,a;if(r.iframelimit){var f=v.min(r.iframelimit/s,r.iframelimit/o);if(f<1){u=s*f;a=o*f;e(this.image).css({top:o/2-a/2,left:s/2-u/2,position:"absolute"})}else{e(this.image).css({top:0,left:0})}}e(this.image).width(u||s).height(a||o).removeAttr("width").removeAttr("height");e(this.container).width(s).height(o);r.complete.call(i,i);try{if(this.image.contentWindow){e(this.image.contentWindow).trigger("resize")}}catch(l){}return this.container}if(!this.image){return this.container}var c,h,p=e(i.container),d;H.wait({until:function(){c=r.width||p.width()||H.parseValue(p.css("width"));h=r.height||p.height()||H.parseValue(p.css("height"));return c&&h},success:function(){var t=(c-r.margin*2)/i.original.width,n=(h-r.margin*2)/i.original.height,s=v.min(t,n),o=v.max(t,n),u={"true":o,width:t,height:n,"false":s,landscape:i.original.width>i.original.height?o:s,portrait:i.original.width<i.original.height?o:s},a=u[r.crop.toString()],f="";if(r.max){a=v.min(r.max,a)}if(r.min){a=v.max(r.min,a)}e.each(["width","height"],function(t,n){e(i.image)[n](i[n]=i.image[n]=v.round(i.original[n]*a))});e(i.container).width(c).height(h);if(r.canvas&&_){_.elem.width=i.width;_.elem.height=i.height;f=i.image.src+":"+i.width+"x"+i.height;i.image.src=_.cache[f]||function(e){_.context.drawImage(i.image,0,0,i.original.width*a,i.original.height*a);try{d=_.elem.toDataURL();_.length+=d.length;_.cache[e]=d;return d}catch(t){return i.image.src}}(f)}var l={},p={},m=function(t,n,r){var s=0;if(/\%/.test(t)){var o=parseInt(t,10)/100,u=i.image[n]||e(i.image)[n]();s=v.ceil(u*-1*o+r*o)}else{s=H.parseValue(t)}return s},g={top:{top:0},left:{left:0},right:{left:"100%"},bottom:{top:"100%"}};e.each(r.position.toLowerCase().split(" "),function(e,t){if(t==="center"){t="50%"}l[e?"top":"left"]=t});e.each(l,function(t,n){if(g.hasOwnProperty(n)){e.extend(p,g[n])}});l=l.top?e.extend(l,p):p;l=e.extend({top:"50%",left:"50%"},l);e(i.image).css({position:"absolute",top:m(l.top,"height",h),left:m(l.left,"width",c)});i.show();i.ready=true;r.complete.call(i,i)},error:function(){t.raise("Could not scale image: "+i.image.src)},timeout:1e3});return this}};e.extend(e.easing,{galleria:function(e,t,n,r,i){if((t/=i/2)<1){return r/2*t*t*t+n}return r/2*((t-=2)*t*t+2)+n},galleriaIn:function(e,t,n,r,i){return r*(t/=i)*t+n},galleriaOut:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n}});t.Fastclick=function(){var n=/iP(ad|hone|od)/.test(navigator.userAgent),s=n&&/OS 4_\d(_\d)?/.test(navigator.userAgent),o=n&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent);return{init:function(n){var i,s=this;this.trackingClick=false;this.trackingClickStart=0;this.targetElement=null;this.touchStartX=0;this.touchStartY=0;this.lastTouchIdentifier=0;this.layer=n;e.each(["Click","TouchStart","TouchMove","TouchEnd","TouchCancel"],function(e,t){s["on"+t]=function(e){return function(){e.apply(s,arguments)}}(s["on"+t])});if(!t.TOUCH){return}n.addEventListener("click",this.onClick,true);n.addEventListener("touchstart",this.onTouchStart,false);n.addEventListener("touchmove",this.onTouchMove,false);n.addEventListener("touchend",this.onTouchEnd,false);n.addEventListener("touchcancel",this.onTouchCancel,false);if(!r.Event.prototype.stopImmediatePropagation){n.removeEventListener=function(e,t,i){var s=r.Node.prototype.removeEventListener;if(e==="click"){s.call(n,e,t.hijacked||t,i)}else{s.call(n,e,t,i)}};n.addEventListener=function(e,t,i){var s=r.Node.prototype.addEventListener;if(e==="click"){s.call(n,e,t.hijacked||(t.hijacked=function(e){if(!e.propagationStopped){t(e)}}),i)}else{s.call(n,e,t,i)}}}if(typeof n.onclick==="function"){i=n.onclick;n.addEventListener("click",function(e){i(e)},false);n.onclick=null}},sendClick:function(e,t){var n,s;if(i.activeElement&&i.activeElement!==e){i.activeElement.blur()}s=t.changedTouches[0];n=i.createEvent("MouseEvents");n.initMouseEvent("click",true,true,r,1,s.screenX,s.screenY,s.clientX,s.clientY,false,false,false,false,0,null);n.forwardedTouchEvent=true;e.dispatchEvent(n)},onTouchStart:function(e){var t,i,o;t=e.target;i=e.targetTouches[0];if(n){o=r.getSelection();if(o.rangeCount&&!o.isCollapsed){return true}if(!s){if(i.identifier===this.lastTouchIdentifier){e.preventDefault();return false}this.lastTouchIdentifier=i.identifier}}this.trackingClick=true;this.trackingClickStart=e.timeStamp;this.targetElement=t;this.touchStartX=i.pageX;this.touchStartY=i.pageY;if(e.timeStamp-this.lastClickTime<200){e.preventDefault()}return true},touchHasMoved:function(e){var t=e.targetTouches[0];if(v.abs(t.pageX-this.touchStartX)>10||v.abs(t.pageY-this.touchStartY)>10){return true}return false},onTouchMove:function(e){if(!this.trackingClick){return true}if(this.targetElement!==e.target||this.touchHasMoved(e)){this.trackingClick=false;this.targetElement=null}return true},onTouchEnd:function(e){var t,n,s,u=this.targetElement;if(!this.trackingClick){return true}if(e.timeStamp-this.lastClickTime<200){this.cancelNextClick=true;return true}this.lastClickTime=e.timeStamp;t=this.trackingClickStart;this.trackingClick=false;this.trackingClickStart=0;if(o){s=e.changedTouches[0];u=e.target;u=i.elementFromPoint(s.pageX-r.pageXOffset,s.pageY-r.pageYOffset)}n=u.tagName.toLowerCase();e.preventDefault();this.sendClick(u,e);return false},onTouchCancel:function(){this.trackingClick=false;this.targetElement=null},onClick:function(e){var t;if(!this.targetElement){return true}if(e.forwardedTouchEvent){return true}t=this.targetElement;this.targetElement=null;if(this.trackingClick){this.trackingClick=false;return true}if(!e.cancelable){return true}if(this.cancelNextClick){this.cancelNextClick=false;if(e.stopImmediatePropagation){e.stopImmediatePropagation()}else{e.propagationStopped=true}e.stopPropagation();e.preventDefault();return false}return true}}}();t.Finger=function(){var n=v.abs;var o=t.HAS3D=function(){var t=i.createElement("p"),n,r=["webkit","O","ms","Moz",""],s,o=0,u="transform";b().html.insertBefore(t,null);for(;r[o];o++){s=r[o]?r[o]+"Transform":u;if(t.style[s]!==undefined){t.style[s]="translate3d(1px,1px,1px)";n=e(t).css(r[o]?"-"+r[o].toLowerCase()+"-"+u:u)}}b().html.removeChild(t);return n!==undefined&&n.length>0&&n!=="none"}();var u=function(){var e="RequestAnimationFrame";return r.requestAnimationFrame||r["webkit"+e]||r["moz"+e]||r["o"+e]||r["ms"+e]||function(e){r.setTimeout(e,1e3/60)}}();var a=function(t,n){this.config={start:0,duration:500,onchange:function(){},oncomplete:function(){},easing:function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n}};if(!t.children.length){return}var i=this;e.extend(this.config,n);this.elem=t;this.child=t.children[0];this.to=this.pos=0;this.touching=false;this.start={};this.index=this.config.start;this.anim=0;if(!o){this.child.style.position="absolute";this.elem.style.position="relative"}e.each(["ontouchstart","ontouchmove","ontouchend","setup"],function(e,t){i[t]=function(e){return function(){e.apply(i,arguments)}}(i[t])});this.setX=function(){var e=i.child.style;if(!o){e.left=i.pos+"px";return}e.MozTransform=e.webkitTransform="translate3d("+i.pos+"px,0,0)";return};e(t).bind("touchstart",this.ontouchstart);e(r).bind("resize",this.setup);e(r).bind("orientationchange",this.setup);this.setup();(function s(){u(s);i.loop.call(i)})()};a.prototype={constructor:a,setup:function(){this.width=e(this.elem).width();this.length=v.ceil(e(this.child).width()/this.width);if(this.index!==0){this.index=v.max(0,v.min(this.index,this.length-1));this.pos=this.to=-this.width*this.index}},setPosition:function(e){this.pos=e;this.to=e},ontouchstart:function(e){var t=e.originalEvent.touches;this.start={pageX:t[0].pageX,pageY:t[0].pageY,time:+(new Date)};this.isScrolling=null;this.touching=true;this.deltaX=0;s.bind("touchmove",this.ontouchmove);s.bind("touchend",this.ontouchend)},ontouchmove:function(e){var t=e.originalEvent.touches;if(t&&t.length>1||e.scale&&e.scale!==1){return}this.deltaX=t[0].pageX-this.start.pageX;if(this.isScrolling===null){this.isScrolling=!!(this.isScrolling||n(this.deltaX)<n(t[0].pageY-this.start.pageY))}if(!this.isScrolling){e.preventDefault();this.deltaX/=!this.index&&this.deltaX>0||this.index==this.length-1&&this.deltaX<0?n(this.deltaX)/this.width+1.8:1;this.to=this.deltaX-this.index*this.width}e.stopPropagation()},ontouchend:function(e){this.touching=false;var t=+(new Date)-this.start.time<250&&n(this.deltaX)>40||n(this.deltaX)>this.width/2,r=!this.index&&this.deltaX>0||this.index==this.length-1&&this.deltaX<0;if(!this.isScrolling){this.show(this.index+(t&&!r?this.deltaX<0?1:-1:0))}s.unbind("touchmove",this.ontouchmove);s.unbind("touchend",this.ontouchend)},show:function(e){if(e!=this.index){this.config.onchange.call(this,e)}else{this.to=-(e*this.width)}},moveTo:function(e){if(e!=this.index){this.pos=this.to=-(e*this.width);this.index=e}},loop:function(){var e=this.to-this.pos,t=1;if(this.width&&e){t=v.max(.5,v.min(2,v.abs(e/this.width)))}if(this.touching||n(e)<=1){this.pos=this.to;if(this.anim){this.config.oncomplete(this.index)}this.anim=0}else{if(!this.anim){this.anim={v:this.pos,c:e,t:+(new Date),f:t}}this.pos=this.config.easing(null,+(new Date)-this.anim.t,this.anim.v,this.anim.c,this.config.duration*this.anim.f)}this.setX()}};return a}();e.fn.galleria=function(n){var r=this.selector;if(!e(this).length){e(function(){if(e(r).length){e(r).galleria(n)}else{t.utils.wait({until:function(){return e(r).length},success:function(){e(r).galleria(n)},error:function(){t.raise('Init failed: Galleria could not find the element "'+r+'".')},timeout:5e3})}});return this}return this.each(function(){if(e.data(this,"galleria")){e.data(this,"galleria").destroy();e(this).find("*").hide()}e.data(this,"galleria",(new t).init(this,n))})}})(jQuery)